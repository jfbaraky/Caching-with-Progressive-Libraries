var _ = require('lodash'),
	gulp = require('gulp'),
	path = require('path'),
	sass = require('gulp-ruby-sass'),
	gulpIf = require('gulp-if'),
	autoprefixer = require('gulp-autoprefixer'),
	minifyCSS = require('gulp-minify-css'),
	defaultConfig = {
		entry: '',
		dest: '',
		minify: false
	};

module.exports = function (config) {
	config = _.assign({}, defaultConfig, config);

	return function () {
		sass(config.entry)
			.on('erorr', function (err) {
				console.log(err.message);
			})
			.pipe(autoprefixer({
                browsers: ['Firefox > 20', 'Chrome > 20'],
                cascade: false
            }))
            .pipe(gulpIf(config.minify, minifyCSS()))
	    	.pipe(gulp.dest(config.dest));
	};
}